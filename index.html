<!DOCTYPE html>
<html>
<head>
<title>BUG的命也是命</title>
</head>
<style>
    body {
        margin: 0
    }
</style>
<shader-toy>
    <script type="frag">
float distLine(vec2 p, vec2 a, vec2 b) {
	vec2 ap = p - a;
    vec2 ab = b - a;
    float aDotB = clamp(dot(ap, ab) / dot(ab, ab), 0.0, 1.0);
    return length(ap - ab * aDotB);
}

float drawLine(vec2 uv, vec2 a, vec2 b) {
    float line = smoothstep(0.014, 0.01, distLine(uv, a, b));
    float dist = length(b-a);
    return line * (smoothstep(1.3, 0.8, dist) * 0.5 + smoothstep(0.04, 0.03, abs(dist - 0.75)));
}

float n21(vec2 i) {
    i += fract(i * vec2(223.64, 823.12));
    i += dot(i, i + 23.14);
    return fract(i.x * i.y);
}

vec2 n22(vec2 i) {
    float x = n21(i);
    return vec2(x, n21(i+x));
}

vec2 getPoint (vec2 id, vec2 offset) {
	return offset + sin(n22(id + offset) * iTime * 1.0) * 0.4;
}

float layer (vec2 uv) {
    float m = 0.0;
    float t = iTime * 2.0;

    vec2 gv = fract(uv) - 0.5;
    vec2 id = floor(uv) - 0.5;

    vec2 p[9];
    int i = 0;
    for (float y = -1.0; y <= 1.0; y++) {
        for (float x = -1.0; x <= 1.0; x++) {
        	p[i++] = getPoint(id, vec2(x,y));
        }
    }

    for (int i = 0; i < 9; i++) {
    	m += drawLine(gv, p[4], p[i]);
        float sparkle = 1.0 / pow(length(gv - p[i]), 1.5) * 0.005;
        m += sparkle * (sin(t + fract(p[i].x) * 12.23) * 0.4 + 0.6);
    }

    m += drawLine(gv, p[1], p[3]);
    m += drawLine(gv, p[1], p[5]);
    m += drawLine(gv, p[7], p[3]);
    m += drawLine(gv, p[7], p[5]);

    return m;
}

void mainImage( out vec4 fragColor, in vec2 fragCoord )
{
    vec2 uv = (fragCoord - 0.5 * iResolution.xy) / iResolution.y;
    vec3 c = sin(iTime * 2.0 * vec3(.234, .324,.768)) * 0.4 + 0.6;
    vec3 col = vec3(0);
    float fft = texelFetch(iChannel0, ivec2(76.0, 0.), 0).x / 2.0 + 0.5;
    c.x += (uv.x + 0.5);
    col += pow(-uv.y + 0.5, 5.0) * fft * c;

    float m = 0.0;
    float x = sin(iTime * 0.1);
    float y = cos(iTime * 0.2);

    mat2 rotMat = mat2(x, y, -y, x);
    uv *= rotMat;

    for (float i = 0.0; i <= 1.0; i+= 1.0/4.0) {
        float z = fract(i + iTime * 0.05);
        float size = mix(15.0, .1, z) * 1.50;
        float fade = smoothstep(0.0, 1.0,  z) * smoothstep(1.0, 0.9, z);
        m += layer((size * uv) + i * 10.0 ) * fade;
    }

    col += m * c;
    // Debug
    fragColor = vec4(col,1.0);
}
    </script>
</shader-toy>
<script src="kokomi.umd.js"></script>
<script>
    kokomi.ShaderToyElement.register();
</script>

<body>
<div id="container" style="width:50%">
<div id="header" style="background-color:#FFA500;">
	<h1 align="center">Bug Lives Matter!</h1>
	<img src='bugp.png'  id='BgImg' width="256" height="256"/></div>
 
<div id="menu" style="background-color:#FFD700;height:10%;width:100px;float:left;">
<b>菜单</b><br>
HTML<br>
CSS<br>
JavaScript</div>
 
<div id="content" style="background-color:#EEEEEE;height:80%;width:80%;float:left;">
<canvas id='canvas' ></canvas>
<p>BUG is very good, but...</p>
<p>Sure, somebody are beating them</p>
<p>Why?</p></div>
 
<div id="footer" style="background-color:#FFA500;clear:both;text-align:center;">
<h3 style="text-align:center">other website</h3>
<a href="https://bugprotectionassociation.itch.io">itch</a></div>

</body>

</html>
